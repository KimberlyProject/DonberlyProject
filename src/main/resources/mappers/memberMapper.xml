<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ezen.member.mapper.memberMapper">
   
   <!-- 경은 -->
   <select id="login" parameterType="com.ezen.member.dto.MemberDTO" resultType="com.ezen.member.dto.MemberDTO">
      SELECT userId, pw, name, nickname, regDate, tel, email, address, repw, zipCode
      FROM   members
      WHERE   userId       = #{userId}
      AND     pw   = #{pw}
   </select>
   <select id="memberLevel" parameterType="com.ezen.member.dto.MemberDTO" resultType="com.ezen.member.dto.MemberDTO">
      SELECT a.*, m.*
      FROM members m, accountstatus a
      WHERE m.userid = a.userid
      AND a.userid = #{userId}
      AND rownum = 1
   </select>
   
	<!-- 회원 아이디 중복 검사 -->
	<select id="idCheck" parameterType="com.ezen.member.dto.MemberDTO" resultType="int">
		SELECT	COUNT(*)
		FROM	members
		WHERE	userId		= #{userId}
	</select>
	
	<select id="findId" parameterType="com.ezen.member.dto.MemberDTO" resultType="string">
		SELECT	userId
		FROM	members
		WHERE	name		= #{name} AND email = #{email}
	</select>
	
	<select id="findPasswd" parameterType="com.ezen.member.dto.MemberDTO" resultType="string">
		SELECT	pw
		FROM	members
		WHERE	userId		= #{userId} AND email = #{email}
	</select>
	
	<!-- 회원 닉네임 중복 검사 -->
	<select id="nickCheck" parameterType="com.ezen.member.dto.MemberDTO" resultType="int">
		SELECT	COUNT(*)
		FROM	members
		WHERE	nickname		= #{nickname}
	</select>
	
	<!-- 회원 가입 POST -->
	<insert id="insert" parameterType="com.ezen.member.dto.MemberDTO">
		INSERT INTO members
				(userId, 	  pw,    name,    nickname, regDate,   tel,     email,    address,    repw, zipCode)
		VALUES	(#{userId},#{pw}, #{name}, #{nickname}, sysdate, #{tel},  #{email}, #{address}, #{repw}, #{zipCode} )
	</insert>

	
	<!-- 12:11 -->	
	<select id="selectMember" resultType="com.ezen.member.dto.MemberDTO">
		SELECT * FROM members
	</select>
	
	<select id="editor" parameterType="String" resultType="MemberDTO">
		select * from members where userId = #{userId}
	</select>
	
	<!-- 회원 아이디에 해당하는 비밀번호, 비밀번호 확인, 이름, 전화번호, 주소를 변경한다.  -->
	<update id="update" parameterType="com.ezen.member.dto.MemberDTO">
		UPDATE	members
		SET		pw			= #{pw},
				repw		= #{repw},
				nickname	= #{nickname},
				name		= #{name},
				tel			= #{tel},
				zipCode		= #{zipCode},
				address		= #{address},
				email		= #{email}
		WHERE	userId		= #{userId}
	</update>
	
	<!-- 09-04 -->
   <select id="profile" parameterType="com.ezen.member.dto.MemberDTO" resultType="com.ezen.member.dto.MemberDTO">
		SELECT	userId, nickname, email
		FROM	members
		WHERE	nickname = #{nickname}
	</select>

	<!-- 회원탈퇴 -->
	<delete id="delete" parameterType="String">
		DELETE	FROM	members
		WHERE	userId		= #{userId}
	</delete>

</mapper>